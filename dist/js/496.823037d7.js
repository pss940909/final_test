"use strict";(self["webpackChunkvue_final_project"]=self["webpackChunkvue_final_project"]||[]).push([[496],{6459:function(t,a,s){s.d(a,{Z:function(){return b}});var e=s(3396),i=s(7139),o=s(9242);const l={"aria-label":"Page navigation example"},n={class:"pagination justify-content-center"},c=(0,e._)("span",{"aria-hidden":"true"},"«",-1),d=[c],r=["onClick"],u=(0,e._)("span",{"aria-hidden":"true"},"»",-1),p=[u];function g(t,a,s,c,u,g){return(0,e.wg)(),(0,e.iD)("nav",l,[(0,e._)("ul",n,[(0,e._)("li",{class:(0,i.C_)(["page-item",{disabled:!s.pages.has_pre}])},[(0,e._)("a",{class:"page-link","aria-label":"Previous",onClick:a[0]||(a[0]=(0,o.iM)((t=>g.updatePage(s.pages.current_page-1)),["prevent"]))},d)],2),((0,e.wg)(!0),(0,e.iD)(e.HY,null,(0,e.Ko)(s.pages.total_pages,(t=>((0,e.wg)(),(0,e.iD)("li",{class:(0,i.C_)(["page-item",{active:s.pages.current_page===t}]),key:t},[(0,e._)("a",{class:"page-link",onClick:(0,o.iM)((a=>g.updatePage(t)),["prevent"])},(0,i.zw)(t),9,r)],2)))),128)),(0,e._)("li",{class:(0,i.C_)(["page-item",{disabled:!s.pages.has_next}])},[(0,e._)("a",{class:"page-link","aria-label":"Next",onClick:a[1]||(a[1]=(0,o.iM)((t=>g.updatePage(s.pages.current_page+1)),["prevent"]))},p)],2)])])}var h={props:["pages"],watch:{pages(t,a){console.log(t,a)}},methods:{updatePage(t){console.log("updatepage"),this.$emit("emitPages",t)}}},_=s(89);const m=(0,_.Z)(h,[["render",g]]);var b=m},4496:function(t,a,s){s.r(a),s.d(a,{default:function(){return F}});var e=s(3396),i=s(7139),o=s(9242);const l={class:"container"},n={class:"row mt-4"},c={class:"col-md-7"},d={class:"table"},r=(0,e._)("thead",null,[(0,e._)("tr",null,[(0,e._)("th",{scope:"col",width:"180"},"圖片"),(0,e._)("th",{scope:"col"},"產品名稱"),(0,e._)("th",{scope:"col"},"價格"),(0,e._)("th",{scope:"col",width:"200"})])],-1),u={scope:"row"},p=["src","alt"],g={class:"text-decoration-line-through"},h={class:"vertical-middle"},_={class:"btn-group btn-group-sm",role:"group","aria-label":"Basic outlined example"},m=["onClick"],b=["disabled"],v={key:0,class:"spinner-border spinner-border-sm text-primary me-2",role:"status"},w=(0,e._)("span",{class:"visually-hidden"},"Loading...",-1),C=[w],k=["onClick"],y={class:"col-md-5"},f={key:0,class:"table table-sm table-hover"},x=(0,e._)("thead",null,[(0,e._)("tr",null,[(0,e._)("th",{scope:"col"}),(0,e._)("th",{scope:"col"},"品名"),(0,e._)("th",{scope:"col"},"數量"),(0,e._)("th",{scope:"col"},"單價")])],-1),L={scope:"row"},D=["onClick"],P=(0,e._)("i",{class:"bi bi-trash"},null,-1),I=[P],z={class:"input-group input-group-sm"},$=["onUpdate:modelValue","onChange","disabled"],q={class:"input-group-text",id:"basic-addon2"},H=(0,e._)("th",{scope:"row",class:"text-center"},"總價",-1),U={colspan:"3",class:"text-end"},Y={class:"text-decoration-line-through"},Z={class:"fw-bold"},j={key:1},K=(0,e._)("i",{class:"bi bi-basket3 me-2"},null,-1),M=(0,e._)("span",null,"購物車內無品項",-1),V=[K,M];function E(t,a,s,w,P,K){const M=(0,e.up)("vue-loading"),E=(0,e.up)("vue-pagination");return(0,e.wg)(),(0,e.iD)(e.HY,null,[(0,e.Wm)(M,{active:P.isLoading},null,8,["active"]),(0,e._)("div",l,[(0,e._)("div",n,[(0,e._)("div",c,[(0,e._)("table",d,[r,(0,e._)("tbody",null,[((0,e.wg)(!0),(0,e.iD)(e.HY,null,(0,e.Ko)(P.productList,(a=>((0,e.wg)(),(0,e.iD)("tr",{key:a.id},[(0,e._)("th",u,[(0,e._)("img",{src:a.imageUrl,alt:a.imageUrl,class:"img-fluid"},null,8,p)]),(0,e._)("td",null,(0,i.zw)(a.title),1),(0,e._)("td",null,[(0,e._)("small",g,(0,i.zw)(t.$filters.currency(a.origin_price)),1),(0,e._)("p",null,(0,i.zw)(t.$filters.currency(a.price)),1)]),(0,e._)("td",h,[(0,e._)("div",_,[(0,e._)("button",{type:"button",class:"btn btn-outline-secondary",onClick:t=>K.showDetails(a.id)}," 更多 ",8,m),(0,e._)("button",{type:"button",class:"btn btn-outline-primary",disabled:P.status.loadingItem===a.id},[P.status.loadingItem===a.id?((0,e.wg)(),(0,e.iD)("div",v,C)):(0,e.kq)("",!0),(0,e._)("span",{onClick:t=>K.addCart(a.id),class:"mb-0"},"加入購物車",8,k)],8,b)])])])))),128))])])]),(0,e._)("div",y,[P.cartList.length?((0,e.wg)(),(0,e.iD)("table",f,[x,(0,e._)("tbody",null,[((0,e.wg)(!0),(0,e.iD)(e.HY,null,(0,e.Ko)(P.cartList,(t=>((0,e.wg)(),(0,e.iD)("tr",{key:t.id,class:"align-middle"},[(0,e._)("th",L,[(0,e._)("button",{class:"btn btn-outline-danger",onClick:a=>K.deleteCartItem(t.id)},I,8,D)]),(0,e._)("td",null,(0,i.zw)(t.product.title),1),(0,e._)("td",null,[(0,e._)("div",z,[(0,e.wy)((0,e._)("input",{type:"number",class:"form-control","onUpdate:modelValue":a=>t.qty=a,min:"1",max:"99",onChange:a=>K.updateCart(t),disabled:this.status.loadingItem==t.id},null,40,$),[[o.nr,t.qty,void 0,{number:!0}]]),(0,e._)("span",q,(0,i.zw)(t.product.unit),1)])]),(0,e._)("td",null,(0,i.zw)(t.final_total),1)])))),128))]),(0,e._)("tfoot",null,[H,(0,e._)("td",U,[(0,e._)("small",Y,(0,i.zw)(P.total),1),(0,e._)("p",Z,(0,i.zw)(t.final_total),1)])])])):((0,e.wg)(),(0,e.iD)("div",j,V))])]),(0,e.Wm)(E,{pages:P.pagination,onEmitPages:K.getProducts},null,8,["pages","onEmitPages"])])],64)}s(7658);var W=s(6459),B={components:{VuePagination:W.Z},data(){return{isLoading:!1,productList:{},cartList:{},total:0,fianl_total:0,pagination:{},status:{loadingItem:""}}},methods:{getProducts(t=1){this.isLoading=!0;const a=`https://vue3-course-api.hexschool.io/api/pss940909/products?page=${t}`;this.axios.get(a).then((t=>{console.log(t.data),t.data.success&&(this.productList=t.data.products,this.pagination=t.data.pagination,this.isLoading=!1)}))},showDetails(t){this.isLoading=!0;const a=`https://vue3-course-api.hexschool.io/api/pss940909/product/${t}`;this.axios.get(a).then((a=>{a.data.success&&(this.$router.push(`/user/products/${t}`),this.isLoading=!1)}))},addCart(t){this.status.loadingItem=t;const a="https://vue3-course-api.hexschool.io/api/pss940909/cart",s={product_id:t,qty:1};this.axios.post(a,{data:s}).then((t=>{console.log(t.data),this.status.loadingItem="",this.getCartList()}))},getCartList(){this.isLoading=!0;const t="https://vue3-course-api.hexschool.io/api/pss940909/cart";this.axios.get(t).then((t=>{console.log(t.data),t.data.success&&(this.cartList=t.data.data.carts,this.total=t.data.data.total,this.final_total=t.data.data.final_total,this.isLoading=!1)}))},deleteCartItem(t){this.isLoading=!0;const a=`https://vue3-course-api.hexschool.io/api/pss940909/cart/${t}`;this.axios.delete(a).then((t=>{console.log(t),this.isLoading=!1,this.getCartList()}))},updateCart(t){this.status.loadingItem=t.id;const a=`https://vue3-course-api.hexschool.io/api/pss940909/cart/${t.id}`,s={product_id:t.product_id,qty:t.qty};this.axios.put(a,{data:s}).then((t=>{t.data.success&&(console.log(t.data),this.status.loadingItem="",this.getCartList())}))}},created(){this.getProducts(),this.getCartList()}},N=s(89);const A=(0,N.Z)(B,[["render",E]]);var F=A}}]);
//# sourceMappingURL=496.823037d7.js.map